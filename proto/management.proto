syntax = "proto3";

package snarf.v1;

message ClientToken {
  string token = 1;
}

message NewClientTokenRequest {
  repeated string capabilities = 1;
}

service ManagementService {
  rpc CreateClientToken(NewClientTokenRequest) returns (ClientToken) {}
  rpc FilterHashes(stream NARHashRequest) returns (stream NARHashResponse);
  rpc AddUpstreamCache(AddUpstreamCacheRequest) returns (AddUpstreamCacheResponse);
  rpc ListUpstreamCaches(ListUpstreamCachesRequest) returns (ListUpstreamCachesResponse);
 }

message NARHashRequest {
  bytes digest = 1;
}

message NARHashResponse {
  bool isUpstream = 1;
}

message AddUpstreamCacheRequest {
  string base_url = 1;
}

message AddUpstreamCacheResponse {
  bool success = 1;
}

message ListUpstreamCachesRequest {}

message ListUpstreamCachesResponse {
  repeated string base_urls = 1;
}
